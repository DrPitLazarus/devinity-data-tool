{"version":3,"file":"bundle.js","sources":["../../src/vars.js","../../src/util.js","../../src/fmRoundsList.js","../../src/fmRoundsDetails.js","../../src/main.js"],"sourcesContent":["const isDev = true;\r\nconst apiPath = isDev ? 'https://ddtapi.now.sh/api' : '/api';\r\n\r\nexport { isDev, apiPath };","import { isDev } from './vars';\r\n\r\nfunction devLog(...msg) {\r\n    if (isDev) console.info(...msg);\r\n}\r\n\r\nfunction setHash(arrData) {\r\n    location.hash = (arrData.map(el => el.join('='))).join('&');\r\n}\r\n\r\nexport { devLog, setHash };","/**\r\n * fmRoundsList.js\r\n * Displays a list of rounds according to the fetch type.\r\n * When the GO button is clicked, it executes the fetch and updates result table.\r\n * When a round is clicked, it is brought to fmRoundsDetails with the ID.\r\n */\r\n\r\nimport { apiPath } from './vars';\r\nimport { devLog } from './util';\r\n\r\nclass fmRoundsList {\r\n    constructor() {\r\n        this.fetchTypeOpts = ['recent', 'server', 'player'];\r\n        this.fetchServerOpts = ['us1', 'us2', 'eu1', 'eu2', 'eu3'];\r\n        this.fetchType = this.fetchTypeOpts[0];\r\n        this.fetchServer = this.fetchServerOpts[0];\r\n        this.setElementRefs();\r\n        this.voidRegisterElementEvents();\r\n        this.labelStatus = \"Ready.\";\r\n    }\r\n\r\n    get labelStatus() {\r\n        return this._labelStatus;\r\n    }\r\n    set labelStatus(value) {\r\n        this._labelStatus = value;\r\n        this.elementRefs.labelStatus.textContent = \"Status: \" + value;\r\n        \r\n    }\r\n\r\n    get tableData() {\r\n        return this._tableData;\r\n    }\r\n    set tableData(value) {\r\n        this._tableData = value;\r\n        this.voidUpdateTableEl();\r\n    }\r\n\r\n    setElementRefs() {\r\n        this.elementRefs = {\r\n            ftypedd: document.querySelector('#fetch-type'),\r\n            fgobtn: document.querySelector('#fetch-btn'),\r\n            fserverdd: document.querySelector('#serverdd'),\r\n            fplayeri: document.querySelector('#fplayeri'),\r\n            labelStatus: document.querySelector('#label-status'),\r\n            hiddenfields: document.querySelectorAll('.-hidden-field'),\r\n            table: document.querySelector('#table')\r\n        };\r\n    }\r\n\r\n    setResults() {\r\n        this.labelStatus = \"Getting data...\"\r\n        fetch(apiPath + this.getApiEndpoint())\r\n            .then(r => r.json())\r\n            .then(r => {\r\n                if (Array.isArray(r)) {\r\n                    this.tableData = r;\r\n                    this.labelStatus = \"Received data. Got \" + r.length + \" results.\";\r\n                    devLog(r);\r\n                }\r\n            })\r\n            .catch(err => {\r\n                console.error(err);\r\n                this.labelStatus = \"Failed to complete request.\"\r\n            })\r\n    }\r\n\r\n    getApiEndpoint() {\r\n        let endpoint = '/fmRoundsList';\r\n        if (this.fetchType === this.fetchTypeOpts[0]) \r\n            return endpoint + \"/list\";\r\n        if (this.fetchType === this.fetchTypeOpts[1]) \r\n            return endpoint + \"/listByServer/\" + this.fetchServer;\r\n        if (this.fetchType === this.fetchTypeOpts[2])\r\n            return endpoint + \"/listByPlayer/\" + this.elementRefs.fplayeri.value;\r\n    }\r\n\r\n    voidRegisterElementEvents() {\r\n        // Fetch type dropdown onchange\r\n        this.elementRefs.ftypedd.onchange = e => {\r\n            this.voidShowHiddenField(e.target.value);\r\n            if (this.fetchTypeOpts.includes(e.target.value)) \r\n                this.fetchType = e.target.value;\r\n        }\r\n        // Fetch server dropdown onchange\r\n        this.elementRefs.fserverdd.onchange = e => {\r\n            if (this.fetchServerOpts.includes(e.target.value))\r\n                this.fetchServer = e.target.value;\r\n            devLog(e.target.value);\r\n        }\r\n        // Fetch go button onclick\r\n        this.elementRefs.fgobtn.onclick = () => {\r\n            if (this.fetchType === this.fetchTypeOpts[2]\r\n                && !/^STEAM_.:[0-1]:\\d+$/.test(this.elementRefs.fplayeri.value)) \r\n                return this.labelStatus = \"Error: Player Steam ID field invalid format.\"\r\n            this.setResults();\r\n        }\r\n    }\r\n\r\n    voidShowHiddenField(field) {\r\n        this.elementRefs.hiddenfields.forEach(el => {\r\n            if (el.dataset.value === field) el.classList = \"\";\r\n            else el.classList = \"is-hidden\";\r\n        });\r\n    }\r\n\r\n    voidUpdateTableEl() {\r\n        let td = (val) => `<td>${val}</td>`;\r\n        let tbody = this.elementRefs.table.querySelector('tbody');\r\n        let tempHtml = '';\r\n        this.tableData.forEach(row => {\r\n            let dateTd = `<a href=\"/fmRoundsDetails#id=${row.id}\">${new Date(row.date).toLocaleString()}</a>`\r\n            tempHtml += '<tr>' + td(dateTd) + td(row.server) + td(row.players) \r\n                + td(row.duration) + td(row.event || '');\r\n        })\r\n        tbody.innerHTML = tempHtml;\r\n    }\r\n}\r\n\r\n\r\nexport default function() {\r\n    new fmRoundsList();\r\n}","import { apiPath } from './vars';\r\nimport { devLog } from './util';\r\n\r\n\r\nclass FMRoundsDetails {\r\n\r\n    constructor() {\r\n        this.setRoundID();\r\n    }\r\n\r\n    setResult() {\r\n\r\n    }\r\n\r\n    setRoundID() {\r\n        let hash = location.hash;\r\n        if (hash.indexOf('#id=') >= 0) {\r\n            let id = hash.substring(4);\r\n            devLog(\"pathAfterSubstring\", id)\r\n            if (/^\\d+$/.test(id)) {\r\n                devLog('id is true', id)\r\n            }\r\n                \r\n        }\r\n            \r\n    }\r\n} \r\n\r\n\r\nexport default function() {\r\n    new FMRoundsDetails();\r\n}","import fmRoundsList from './fmRoundsList';\r\nimport fmRoundsDetails from './fmRoundsDetails';\r\n\r\nfunction isPathExecute(target, callback) {\r\n    location.pathname === target && callback();\r\n}\r\n\r\nisPathExecute('/fmRoundsList', fmRoundsList);\r\nisPathExecute('/fmRoundsDetails', fmRoundsDetails);\r\n"],"names":["fmRoundsList"],"mappings":"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"}